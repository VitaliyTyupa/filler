# Web Filler Game — Project Overview

## 1. Короткий опис

Браузерна стратегічна гра для 2–4 гравців. Гравці по черзі захоплюють клітинки ігрового поля, обираючи колір. Захоплення відбувається за правилами суміжності та з урахуванням ефектів клітинок. Гра триває, доки всі клітинки не матимуть власника. Перемагає гравець із найбільшою кількістю клітинок.

Проєкт орієнтований на **високу продуктивність**, **GPU‑рендеринг** і **плавні анімації** при розмірі поля до 10 000 клітинок.

---

## 2. Основні параметри гри

* **Розмір поля:** 1 000 – 10 000 клітинок
* **Кількість гравців:** 2–4
* **Кількість кольорів:** 7–21
* **Тип сітки:** регулярна (квадратна або гекс — визначається окремо)
* **Режим гри:** покроковий

---

## 3. Клітинка (Cell) — модель

Кожна клітинка має фіксований набір властивостей:

### 3.1 Стан

* `free` — без власника
* `owned` — належить гравцю

### 3.2 Колір

* Один з обмеженого набору кольорів
* Може змінюватись під час гри

### 3.3 Ефект (Effect)

Впливає на поведінку під час захоплення:

* `normal` — стандартна логіка
* `frozen` — при ході сусідні **вільні** клітинки не враховуються
* `boosted` — захоплює суміжні клітинки незалежно від вибраного кольору

### 3.4 Тип (Type)

Визначає умовні ефекти на основі сусідів:

* приклад: `dark`

  * якщо поруч ≥ 2 темних клітинок → накладається `frozen`

> Усі ефекти рахуються **локально** (через сусідів), без глобальних сканів поля.

---

## 4. Основна ігрова логіка

* Кожен гравець стартує з кутової клітинки
* Стартовий колір = колір стартової клітинки
* Хід гравця:

  1. Обирає новий колір
  2. Відбувається захоплення суміжних клітинок
  3. Застосовуються ефекти та типи клітинок
* Логіка захоплення реалізується як **BFS / flood‑fill від frontier**, а не від усього поля

---

## 5. Архітектура застосунку

### 5.1 Загальний поділ

* **Main thread (UI / Render)**

  * Three.js рендер
  * Анімації, hover, idle‑ефекти
  * Прийом diff‑оновлень від логіки гри

* **Web Worker (Game Logic)**

  * Уся логіка ходів
  * BFS захоплення
  * Розрахунок ефектів
  * Формування `diff` (тільки змінені клітинки)

---

## 6. Рендеринг

### 6.1 Технологія

* **Three.js**
* **InstancedMesh** — 1 mesh на все поле
* Одна геометрія, мінімум матеріалів

### 6.2 GPU‑підхід

* Дані клітинок передаються як **instanced attributes**
* Flip‑анімація реалізується в **shader**
* Hover та idle‑ефекти — shader‑based

### 6.3 Заборонено

* DOM‑елементи на клітинку
* SVG‑рендер поля
* Перебудова mesh при кожному ході

---

## 7. Дані та продуктивність

### 7.1 Формат даних

* `Uint8Array` / `Float32Array`
* Без об’єктів на клітинку

Приклад:

* owner: `Uint8Array`
* color: `Uint8Array`
* effect: `Uint8Array`
* type: `Uint8Array`

### 7.2 Оновлення

* Тільки **diff‑оновлення**
* Оновлюються лише змінені інстанс‑атрибути

---

## 8. Анімації та інтерактивність

* Idle‑анімація поля (легка, shader‑based)
* Hover‑реакція клітинки
* Flip‑анімація при зміні кольору/власника
* Ціль: **60 FPS** на desktop при 10k клітинок

---

## 9. Frontend стек

* **Angular 18+**
* **TypeScript**
* **Three.js**
* Web Workers

---

## 10. Розробка з AI (Codex)

### 10.1 Принцип

* Людина — архітектор і рев’юер
* Codex — виконавець дрібних, чітких задач

### 10.2 Правила для Codex

* Маленькі задачі
* Чіткі acceptance‑критерії
* Заборона змінювати архітектурні рішення без запиту
* InstancedMesh — обовʼязково

---

## 11. Не входить у поточний scope

* Мережевий multiplayer
* AI‑суперники
* Mobile‑first оптимізація
* Складний post‑processing

---

## 12. Ціль проєкту

Створити масштабовану, візуально живу браузерну гру, яка:

* стабільно працює з 10k клітинок
* має чітку архітектуру
* зручна для ітеративної розробки з Codex
* легко розширюється новими ефектами клітинок
